<div fxLayoutAlign="center center" fxFlex="100">
  <form [formGroup]="formGroup">
    <div fxLayout="column" fxLayoutGap="10px" fxFlex="100" *ngIf="!showCompanyForm">

      <div>
        <mat-form-field fxFlex="100">
          <input matInput
                 placeholder="Wyszukaj firmę"
                 aria-label="Wyszukaj firmę"
                 [matAutocomplete]="companyAutoComp"
                 [formControl]="companyIdCtrl"
                 required>

          <mat-autocomplete #companyAutoComp="matAutocomplete" [displayWith]="companyDisplayFn">
            <mat-option *ngIf="(filteredCompanies | async)?.length === 0" [value]="-1" [disabled]="true">
              <span>Nie znaleziono</span>
            </mat-option>

            <mat-option *ngFor="let company of filteredCompanies | async" [value]="company">
              <!--<img style="vertical-align:middle;" aria-hidden src="{{state.flag}}" height="25" />-->
              <span>{{ company.name }}</span>
            </mat-option>

          </mat-autocomplete>
        </mat-form-field>
      </div>
      <!--<div>-->
      <!--Wybrano: {{companyIdCtrl?.value?.name}}-->
      <!--</div>-->

      <button mat-raised-button aria-label="Dodaj nową firme" color="primary" (click)="showNewCompanyForm()">
        <mat-icon>add</mat-icon>
        Dodaj nową firme
      </button>

    </div>
  </form>

  <form [formGroup]="newCompanyFormGroup">
    <div fxLayout="column" fxLayoutGap="10px" fxFlex="100" *ngIf="showCompanyForm">

      <div>
        <mat-form-field fxFlex="100">
          <input matInput
                 formControlName="nameCtrl"
                 type="text"
                 placeholder="Nazwa firmy"
                 required>
        </mat-form-field>
      </div>

      <span>Logo</span>
      <div fxLayoutAlign="center center">
        <div *ngIf="imagePreview" class="image-preview-container">
          <img mat-card-avatar class="image-preview" [src]="imagePreview.src" alt="logo firmy">
          <div class="middle" style="cursor: pointer;" (click)="removeImage()">
            <mat-icon color="primary">delete</mat-icon>
          </div>
        </div>
      </div>

      <div>
        <input #imageInput
               fxFlex="100"
               (change)="loadImage($event)"
               accept="image/*"
               type="file"
               required>
      </div>

      <div fxLayout.lt-sm="column" fxLayout="row" fxLayoutGap="10px">
        <button mat-raised-button aria-label="Dodaj" color="primary" (click)="addCompany()" fxFlex="50">
          <mat-icon>add</mat-icon>
          Dodaj
        </button>

        <button mat-raised-button aria-label="Anuluj" color="primary" (click)="cancelAdd()" fxFlex="50">
          <mat-icon>cancel</mat-icon>
          Anuluj
        </button>
      </div>

    </div>
  </form>
</div>
